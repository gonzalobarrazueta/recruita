<div class="chat-container">
  <div class="chat-box">
    <div class="chat-header">
      <h1>Crea una nueva oferta laboral</h1>
      <p>Utiliza este espacio para redactar una descripción del trabajo que quieres crear. El agente se encargará de estructurarlo y añadir el puesto de trabajo.</p>
    </div>

    <div class="chat-messages" #scrollContainer>
      @for (message of messages; track message) {
        @if (message.sender == "user") {
          <div class="message message-type-user">
            <span class="message-text">{{ message.content }}</span>
          </div>
        } @else {
          <!-- AI response -->
          <div class="message message-type-ai" [innerHtml]="message.content | markdown"></div>
        }
      }

      @if (waitingForAgentResponse) {
        <div class="message message-type-ai">
        <span class="message-text">
          <span class="dot"></span>
          <span class="dot"></span>
          <span class="dot"></span>
        </span>
        </div>
      }
    </div>

    @if (selectedFile) {
      <div class="file-preview">
        <div class="file-selected">
          <span class="file-name">{{ selectedFile.name }}</span>
        </div>
      </div>
    }

    <form class="chat-input" [formGroup]="chatForm" (ngSubmit)="sendMessage()">
      <input class="add-file" type="file" #fileUpload (change)="onFileSelected($event)"
             accept=".doc, .docx, .pdf, .txt">
      <button class="icon-button" type="button" (click)="fileUpload.click()">
        <span class="material-symbols-rounded">attach_file_add</span>
      </button>
      <input class="user-message" type="text" placeholder="Escribe aquí..." formControlName="userInput" required/>
      <button class="icon-button send-msg-button" type="submit">
        <span class="material-symbols-rounded">send</span>
      </button>
    </form>
  </div>
</div>
